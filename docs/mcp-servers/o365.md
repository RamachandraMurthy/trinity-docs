---
sidebar_position: 1
title: O365 Server
description: MCP server that connects the AI to a user's own Microsoft 365 calendar to identify external meetings for Daily Recap
---

# O365 MCP Server

## Overview

The **O365 MCP Server** is a Model Context Protocol (MCP) server that provides the AI with access to a user's own Microsoft 365 calendar through the Microsoft Graph API. Its primary purpose is to identify **external meetings** — meetings that involve participants from outside the user's organization — to support the **Daily Recap** feature in Trinity.

When a user receives their Daily Recap, the AI calls this MCP server to retrieve calendar events, analyze which meetings are internal versus external, and highlight any upcoming or recent client-facing engagements. This helps users stay aware of their external commitments without manually reviewing their calendar.

---

## Privacy and Data Access

This server connects exclusively to the **individual user's own Microsoft 365 account**. No administrator, manager, or other user can access another person's calendar data through this server.

| Privacy Principle | How It's Enforced |
|-------------------|-------------------|
| **User-only access** | The server authenticates with the user's own credentials; it cannot read anyone else's calendar |
| **No shared storage** | Calendar data is retrieved on demand and not stored on Trinity servers |
| **No cross-user visibility** | There is no mechanism for one user to view another user's meetings through this server |
| **Scoped permissions** | The server requests only the calendar permissions needed to read meeting details |

Your calendar information remains private to you.

---

## What Data It Provides

The server retrieves calendar event data from the user's Microsoft 365 account:

| Dataset | What It Contains |
|---------|------------------|
| **Calendar Events** | Meetings and appointments — subject, start/end time, location, organizer, attendees, and whether the meeting is online |
| **Organizer Details** | Name, email address, and email domain of the meeting organizer |
| **Attendee Details** | Name, email address, email domain, and response status for each attendee |

The email domain of organizers and attendees is the key data point that determines whether a meeting is internal (same domain as the user) or external (different domain).

---

## Data Model

Calendar events include nested details about the organizer and each attendee. The domain information is what allows the AI to classify meetings as internal or external:

```
    ┌──────────────────────────────────────────────────────────────────┐
    │             USER'S OWN MICROSOFT 365 CALENDAR                   │
    │                  (Private to the user)                          │
    └──────────────────────────────┬───────────────────────────────────┘
                                   │
                                   ▼
                    ┌─────────────────────────────┐
                    │       CALENDAR EVENT        │
                    ├─────────────────────────────┤
                    │  • Subject                  │
                    │  • Start / End Time         │
                    │  • Location                 │
                    │  • Online Meeting Flag      │
                    │  • Organizer ───────────┐   │
                    │  • Attendees ─────────┐ │   │
                    └───────────────────────┼─┼───┘
                                            │ │
                           ┌────────────────┘ └────────────────┐
                           ▼                                    ▼
                ┌──────────────────────┐             ┌──────────────────────┐
                │      ATTENDEE        │             │      ORGANIZER       │
                ├──────────────────────┤             ├──────────────────────┤
                │  • Name              │             │  • Name              │
                │  • Email             │             │  • Email             │
                │  • Domain  ◄─────────┼─────────────┼──► Domain            │
                │  • Response Status   │             │                      │
                └──────────────────────┘             └──────────────────────┘
                                    │                           │
                                    └───────────┬───────────────┘
                                                │
                                                ▼
                                  ┌──────────────────────────┐
                                  │   INTERNAL vs EXTERNAL   │
                                  │      CLASSIFICATION      │
                                  ├──────────────────────────┤
                                  │  Same domain as user =   │
                                  │      Internal meeting    │
                                  │                          │
                                  │  Different domain =      │
                                  │      External meeting    │
                                  └──────────────────────────┘
```

---

## How It Works

When Trinity generates a Daily Recap or the user asks about their external meetings, the request flows through the system like this:

```
    ┌──────────┐
    │   USER   │
    └────┬─────┘
         │ Daily Recap request or
         │ "What external meetings do I have?"
         ▼
    ┌──────────┐
    │    AI    │  Determines it needs calendar data
    └────┬─────┘  to identify external meetings
         │
         ▼
    ┌──────────┐
    │ BACKEND  │  Routes the request to the
    └────┬─────┘  O365 MCP Server
         │
         ▼
    ┌─────────────────────────────┐
    │  O365 MCP SERVER           │  Authenticates as the user,
    │                            │  requests calendar events
    └────┬────────────────────────┘
         │
         ▼
    ┌──────────────┐
    │  MICROSOFT   │  Graph API v1.0 —
    │  GRAPH API   │  the user's own calendar only
    └────┬─────────┘
         │
         │ Returns the user's meetings
         ▼
    ┌─────────────────────────────┐
    │  O365 MCP SERVER           │  Compares attendee domains to
    │                            │  user's domain, classifies each
    │                            │  meeting as internal or external
    └────┬────────────────────────┘
         │
         ▼
    ┌──────────┐
    │    AI    │  Incorporates external meeting
    └────┬─────┘  info into Daily Recap
         │
         ▼
    ┌──────────┐
    │   USER   │  "You have 3 external meetings today:
    └──────────┘   a call with Contoso at 10am..."
```

---

## Capabilities

The server provides capabilities focused on calendar analysis for external meeting detection:

| Capability | What It Does |
|------------|--------------|
| **View calendar events** | Retrieves meetings and appointments for a given date range or number of days ahead |
| **Check meeting type** | Analyzes a specific meeting to determine if it is internal (all attendees from the same organization) or external (attendees from outside domains) |
| **Analyze calendar** | Reviews all meetings in a time period and produces a breakdown of how many are internal versus external, including the outside domains involved |

These capabilities power the **Daily Recap** feature by surfacing external meetings — such as client calls, vendor discussions, or partner engagements — so users can prepare for or reflect on their external-facing time.

---

## Use in Daily Recap

The primary use case for this server is the **Daily Recap** feature. Each day, Trinity can:

- Identify which meetings on the user's calendar involve external participants
- Highlight upcoming client or partner engagements
- Summarize how much of the user's day is spent in external-facing meetings
- Help users prepare context for important external calls

This gives users a quick, actionable view of their external commitments without exposing their full calendar details or sharing data with others.

---

## Related Documentation

| Section | What You'll Learn |
|---------|-------------------|
| [MCP Servers Overview](/docs/mcp-servers) | How MCP servers connect the AI to business data |
| [Authentication & Security](/docs/authentication) | How user tokens enable secure access to Microsoft 365 |
| [AI & Models](/docs/ai-and-mcp) | How the AI brain works with data tools |
| [Backend Architecture](/docs/backend) | How the backend coordinates data requests |
